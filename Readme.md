

# Адресация сервисов

| Сервис     | Порт HTTP | Порт HTTPS |
|------------|-----------|------------|
| Cart       | 8101      | 8201       |
| Favourite  | 8102      | 8202       |
| Catalog    | 8103      | 8203       |
| Users/Auth | 8104      | 8204       |
| Frontend   | 8105      | 8205       |
| Orders     | 8106      | 8206       |
| Storage    | 8107      | 8207       |

Для добавления сервиса в деплой надо:

1. В папке ./ApiGate/services добавить 2 файла: NAME-location.conf и NAME-upstream.conf, 
где NAME - короткое название сервиса. Первый содержит описание перенаправления запросов 
клиента на соответствующий сервис. Второй - описание расположения самого сервиса
2. Добавить запуск сервисов в compose.yaml
3. Проверить корректность (выполнить в корне решения ```docker compose -f compose.prod.yaml up```, 
 сервис должен быть доступен по настроенному URL). 
 
Как отлаживать свой сервис:

1. Открыть nginx.debug.config и в файле своего сервиса:
   1. раскомментировать конфигурацию из папки dev.
   2. закомментировать конфигурацию из папки services.
2. Запустить compose.dev.yaml ```docker compose -f compose.dev.yaml up```
3. Остановить контейнер своего сервиса.
4. Запустить фронт (```npm run dev```) 
5. Запустить свой сервис под отладкой (нужные порты уже настроены в launchSettings.json).
6. Дальше необходим перезапуск (при необходимости) только своего сервиса под отладкой.

Запуск в "Production" - режиме:

```shell
docker compose -f compose.prod.yaml up
```
